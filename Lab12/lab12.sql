        CREATE TABLE TRANSAKCJE (
        ID_TRANSAKCJI DECIMAL(12, 0) NOT NULL ,
        NR_KONTA VARCHAR(30) NOT NULL ,
        DATA DATE NOT NULL ,
        KWOTA DECIMAL(10, 2) NOT NULL ,
        TYP VARCHAR(10),
        KATEGORIA VARCHAR(20));
        INSERT INTO TRANSAKCJE(ID_TRANSAKCJI, NR_KONTA, DATA, KWOTA, TYP, KATEGORIA) VALUES (10000, '11-11111111', TO_DATE('03.01.1997','DD.MM.YYYY'), 1500, 'WPŁATA', 'PENSJA');
        INSERT INTO TRANSAKCJE(ID_TRANSAKCJI, NR_KONTA, DATA, KWOTA, TYP, KATEGORIA) VALUES (10010,'11-11111111',TO_DATE('12.01.1997','DD.MM.YYYY'), -100, 'WYPŁATA', 'WYPŁATA W BANKOMACIE');
        INSERT INTO TRANSAKCJE(ID_TRANSAKCJI, NR_KONTA, DATA, KWOTA, TYP, KATEGORIA) VALUES (10020, '11-11111111', TO_DATE('02.02.1997','DD.MM.YYYY'), 750, 'WPŁATA', 'UMOWA O DZIEŁO');
        INSERT INTO TRANSAKCJE(ID_TRANSAKCJI, NR_KONTA, DATA, KWOTA, TYP, KATEGORIA) VALUES (10030, '11-11111111', TO_DATE('22.05.1998','DD.MM.YYYY'), -150, 'WYPŁATA', 'RACHUNEK ZA TELEFON');
        INSERT INTO TRANSAKCJE(ID_TRANSAKCJI, NR_KONTA, DATA, KWOTA, TYP, KATEGORIA) VALUES (10040, '11-11111111', TO_DATE('04.11.1999','DD.MM.YYYY'), 1800, 'WPŁATA', 'PENSJA');
        INSERT INTO TRANSAKCJE(ID_TRANSAKCJI, NR_KONTA, DATA, KWOTA, TYP, KATEGORIA) VALUES (10050, '11-11111111', TO_DATE('02.12.1999','DD.MM.YYYY'), 1800, 'WPŁATA', 'PENSJA');
        INSERT INTO TRANSAKCJE(ID_TRANSAKCJI, NR_KONTA, DATA, KWOTA, TYP, KATEGORIA) VALUES (10060, '11-11111111', TO_DATE('24.12.1999','DD.MM.YYYY'), -120.5, 'WYPŁATA', 'RACHUNEK ZA PRAD');
        INSERT INTO TRANSAKCJE(ID_TRANSAKCJI, NR_KONTA, DATA, KWOTA, TYP, KATEGORIA) VALUES (10070, '11-11111111', TO_DATE('24.12.1999','DD.MM.YYYY'), -300, 'WYPŁATA', 'WYPŁATA W BANKOMACIE');
        INSERT INTO TRANSAKCJE(ID_TRANSAKCJI, NR_KONTA, DATA, KWOTA, TYP, KATEGORIA) VALUES (10080, '11-11111111', TO_DATE('19.01.2000','DD.MM.YYYY'), -150, 'WYPŁATA', 'RACHUNEK ZA TELEFON');
        INSERT INTO TRANSAKCJE(ID_TRANSAKCJI, NR_KONTA, DATA, KWOTA, TYP, KATEGORIA) VALUES (10090, '11-11111111', TO_DATE('03.05.2000','DD.MM.YYYY'), 900, 'WPŁATA', 'UMOWA O DZIEŁO');
        INSERT INTO TRANSAKCJE(ID_TRANSAKCJI, NR_KONTA, DATA, KWOTA, TYP, KATEGORIA) VALUES (10100, '11-11111111', TO_DATE('16.07.2001','DD.MM.YYYY'), -600, 'WYPŁATA', 'RACHUNEK ZA PRAD');
        INSERT INTO TRANSAKCJE(ID_TRANSAKCJI, NR_KONTA, DATA, KWOTA, TYP, KATEGORIA) VALUES (10110, '11-11111111', TO_DATE('24.07.2001','DD.MM.YYYY'), -150, 'WYPŁATA', 'WYPŁATA W BANKOMACIE');
        INSERT INTO TRANSAKCJE(ID_TRANSAKCJI, NR_KONTA, DATA, KWOTA, TYP, KATEGORIA) VALUES (10120, '11-11111111', TO_DATE('03.09.2001','DD.MM.YYYY'), 1400, 'WPŁATA', 'PENSJA');
        INSERT INTO TRANSAKCJE(ID_TRANSAKCJI, NR_KONTA, DATA, KWOTA, TYP, KATEGORIA) VALUES (10130, '11-11111111', TO_DATE('29.09.2001','DD.MM.YYYY'), -250, 'WYPŁATA', 'RACHUNEK ZA TELEFON');
        INSERT INTO TRANSAKCJE(ID_TRANSAKCJI, NR_KONTA, DATA, KWOTA, TYP, KATEGORIA) VALUES (10140, '11-11111111', TO_DATE('03.12.2001','DD.MM.YYYY'), 1650, 'WPŁATA', 'PENSJA');
        INSERT INTO TRANSAKCJE(ID_TRANSAKCJI, NR_KONTA, DATA, KWOTA, TYP, KATEGORIA) VALUES (10150, '11-11111111', TO_DATE('05.01.2002','DD.MM.YYYY'), -500, 'WYPŁATA', 'WYPŁATA W BANKOMACIE');
        INSERT INTO TRANSAKCJE(ID_TRANSAKCJI, NR_KONTA, DATA, KWOTA, TYP, KATEGORIA) VALUES (10001, '22-22222222', TO_DATE('03.04.1998','DD.MM.YYYY'), 1650, 'WPŁATA', 'PENSJA');
        INSERT INTO TRANSAKCJE(ID_TRANSAKCJI, NR_KONTA, DATA, KWOTA, TYP, KATEGORIA) VALUES (10011, '22-22222222', TO_DATE('12.01.1997','DD.MM.YYYY'), 1000, 'WPŁATA', 'PENSJA');
        INSERT INTO TRANSAKCJE(ID_TRANSAKCJI, NR_KONTA, DATA, KWOTA, TYP, KATEGORIA) VALUES (10021, '22-22222222', TO_DATE('02.09.1997','DD.MM.YYYY'), 830, 'WPŁATA', 'UMOWA O DZIEŁO');
        INSERT INTO TRANSAKCJE(ID_TRANSAKCJI, NR_KONTA, DATA, KWOTA, TYP, KATEGORIA) VALUES (10031, '22-22222222', TO_DATE('22.03.1998','DD.MM.YYYY'), -170, 'WYPŁATA', 'RACHUNEK ZA TELEFON');
        INSERT INTO TRANSAKCJE(ID_TRANSAKCJI, NR_KONTA, DATA, KWOTA, TYP, KATEGORIA) VALUES (10041, '22-22222222', TO_DATE('04.05.2001','DD.MM.YYYY'), 1980, 'WPŁATA', 'PENSJA');
        INSERT INTO TRANSAKCJE(ID_TRANSAKCJI, NR_KONTA, DATA, KWOTA, TYP, KATEGORIA) VALUES (10051, '22-22222222', TO_DATE('02.07.2001','DD.MM.YYYY'), 2090, 'WPŁATA', 'PENSJA');
        INSERT INTO TRANSAKCJE(ID_TRANSAKCJI, NR_KONTA, DATA, KWOTA, TYP, KATEGORIA) VALUES (10061, '22-22222222', TO_DATE('24.10.1999','DD.MM.YYYY'), -130.5, 'WYPŁATA', 'RACHUNEK ZA PRAD');
        INSERT INTO TRANSAKCJE(ID_TRANSAKCJI, NR_KONTA, DATA, KWOTA, TYP, KATEGORIA) VALUES (10071, '22-22222222', TO_DATE('02.10.1999','DD.MM.YYYY'), -330, 'WYPŁATA', 'WYPŁATA W BANKOMACIE');
        INSERT INTO TRANSAKCJE(ID_TRANSAKCJI, NR_KONTA, DATA, KWOTA, TYP, KATEGORIA) VALUES (10081, '22-22222222', TO_DATE('19.12.1999','DD.MM.YYYY'), -110, 'WYPŁATA', 'RACHUNEK ZA TELEFON');
        INSERT INTO TRANSAKCJE(ID_TRANSAKCJI, NR_KONTA, DATA, KWOTA, TYP, KATEGORIA) VALUES (10091, '22-22222222', TO_DATE('03.02.2001','DD.MM.YYYY'), 990, 'WPŁATA', 'UMOWA O DZIEŁO');
        INSERT INTO TRANSAKCJE(ID_TRANSAKCJI, NR_KONTA, DATA, KWOTA, TYP, KATEGORIA) VALUES (10101, '22-22222222', TO_DATE('16.01.2001','DD.MM.YYYY'), -660, 'WYPŁATA', 'RACHUNEK ZA PRAD');
        INSERT INTO TRANSAKCJE(ID_TRANSAKCJI, NR_KONTA, DATA, KWOTA, TYP, KATEGORIA) VALUES (10111, '22-22222222', TO_DATE('24.05.2001','DD.MM.YYYY'), -170, 'WYPŁATA', 'WYPŁATA W BANKOMACIE');
        INSERT INTO TRANSAKCJE(ID_TRANSAKCJI, NR_KONTA, DATA, KWOTA, TYP, KATEGORIA) VALUES (10121, '22-22222222', TO_DATE('03.11.2002','DD.MM.YYYY'), 1540, 'WPŁATA', 'PENSJA');
        INSERT INTO TRANSAKCJE(ID_TRANSAKCJI, NR_KONTA, DATA, KWOTA, TYP, KATEGORIA) VALUES (10131, '22-22222222', TO_DATE('29.06.2001','DD.MM.YYYY'), -280, 'WYPŁATA', 'RACHUNEK ZA TELEFON');
        INSERT INTO TRANSAKCJE(ID_TRANSAKCJI, NR_KONTA, DATA, KWOTA, TYP, KATEGORIA) VALUES (10141, '22-22222222', TO_DATE('03.04.2003','DD.MM.YYYY'), 1820, 'WPŁATA', 'PENSJA');
        INSERT INTO TRANSAKCJE(ID_TRANSAKCJI, NR_KONTA, DATA, KWOTA, TYP, KATEGORIA) VALUES (10151, '22-22222222', TO_DATE('05.08.2001','DD.MM.YYYY'), -550, 'WYPŁATA', 'WYPŁATA W BANKOMACIE');
        INSERT INTO TRANSAKCJE(ID_TRANSAKCJI, NR_KONTA, DATA, KWOTA, TYP, KATEGORIA) VALUES (10002, '33-33333333', TO_DATE('03.10.1995','DD.MM.YYYY'), 1350, 'WPŁATA', 'PENSJA');
        INSERT INTO TRANSAKCJE(ID_TRANSAKCJI, NR_KONTA, DATA, KWOTA, TYP, KATEGORIA) VALUES (10012, '33-33333333', TO_DATE('12.02.1997','DD.MM.YYYY'), -90, 'WYPŁATA', 'WYPŁATA W BANKOMACIE');
        INSERT INTO TRANSAKCJE(ID_TRANSAKCJI, NR_KONTA, DATA, KWOTA, TYP, KATEGORIA) VALUES (10022, '33-33333333', TO_DATE('02.07.1996','DD.MM.YYYY'), 670, 'WPŁATA', 'UMOWA O DZIEŁO');
        INSERT INTO TRANSAKCJE(ID_TRANSAKCJI, NR_KONTA, DATA, KWOTA, TYP, KATEGORIA) VALUES (10032, '33-33333333', TO_DATE('22.07.1998','DD.MM.YYYY'), -130, 'WYPŁATA', 'RACHUNEK ZA TELEFON');
        INSERT INTO TRANSAKCJE(ID_TRANSAKCJI, NR_KONTA, DATA, KWOTA, TYP, KATEGORIA) VALUES (10042, '33-33333333', TO_DATE('04.05.1998','DD.MM.YYYY'), 1620, 'WPŁATA', 'PENSJA');
        INSERT INTO TRANSAKCJE(ID_TRANSAKCJI, NR_KONTA, DATA, KWOTA, TYP, KATEGORIA) VALUES (10052, '33-33333333', TO_DATE('02.05.1998','DD.MM.YYYY'), 1710, 'WPŁATA', 'PENSJA');
        INSERT INTO TRANSAKCJE(ID_TRANSAKCJI, NR_KONTA, DATA, KWOTA, TYP, KATEGORIA) VALUES (10062, '33-33333333', TO_DATE('24.02.2000','DD.MM.YYYY'), -110.5, 'WYPŁATA', 'RACHUNEK ZA PRAD');
        INSERT INTO TRANSAKCJE(ID_TRANSAKCJI, NR_KONTA, DATA, KWOTA, TYP, KATEGORIA) VALUES (10072, '33-33333333', TO_DATE('02.04.2000','DD.MM.YYYY'), -270, 'WYPŁATA', 'WYPŁATA W BANKOMACIE');
        INSERT INTO TRANSAKCJE(ID_TRANSAKCJI, NR_KONTA, DATA, KWOTA, TYP, KATEGORIA) VALUES (10082, '33-33333333', TO_DATE('19.02.2000','DD.MM.YYYY'), -90, 'WYPŁATA', 'RACHUNEK ZA TELEFON');
        INSERT INTO TRANSAKCJE(ID_TRANSAKCJI, NR_KONTA, DATA, KWOTA, TYP, KATEGORIA) VALUES (10092, '33-33333333', TO_DATE('03.08.1999','DD.MM.YYYY'), 810, 'WPŁATA', 'UMOWA O DZIEŁO');
        INSERT INTO TRANSAKCJE(ID_TRANSAKCJI, NR_KONTA, DATA, KWOTA, TYP, KATEGORIA) VALUES (10102, '33-33333333', TO_DATE('16.01.2002','DD.MM.YYYY'), -540, 'WYPŁATA', 'RACHUNEK ZA PRAD');
        INSERT INTO TRANSAKCJE(ID_TRANSAKCJI, NR_KONTA, DATA, KWOTA, TYP, KATEGORIA) VALUES (10112, '33-33333333', TO_DATE('24.09.2001','DD.MM.YYYY'), -130, 'WYPŁATA', 'WYPŁATA W BANKOMACIE');
        INSERT INTO TRANSAKCJE(ID_TRANSAKCJI, NR_KONTA, DATA, KWOTA, TYP, KATEGORIA) VALUES (10122, '33-33333333', TO_DATE('03.07.2000','DD.MM.YYYY'), 1260, 'WPŁATA', 'PENSJA');
        INSERT INTO TRANSAKCJE(ID_TRANSAKCJI, NR_KONTA, DATA, KWOTA, TYP, KATEGORIA) VALUES (10132, '33-33333333', TO_DATE('29.12.2001','DD.MM.YYYY'), -220, 'WYPŁATA', 'RACHUNEK ZA TELEFON');
        INSERT INTO TRANSAKCJE(ID_TRANSAKCJI, NR_KONTA, DATA, KWOTA, TYP, KATEGORIA) VALUES (10142, '33-33333333', TO_DATE('03.08.2000','DD.MM.YYYY'), 1480, 'WPŁATA', 'PENSJA');
        INSERT INTO TRANSAKCJE(ID_TRANSAKCJI, NR_KONTA, DATA, KWOTA, TYP, KATEGORIA) VALUES (10152, '33-33333333', TO_DATE('05.06.2002','DD.MM.YYYY'), -450, 'WYPŁATA', 'WYPŁATA W BANKOMACIE');


---Należy skonstruować zapytania, których wynikiem jest:
--
--     zad1
--
--         nr_konta   |   typ   |      kategoria       |   sum
--     -------------+---------+----------------------+----------
--      11-11111111 | WPŁATA  | PENSJA               |  8150.00
--      11-11111111 | WPŁATA  | UMOWA O DZIEŁO       |  1650.00
--      11-11111111 | WPŁATA  |                      |  9800.00
--      11-11111111 | WYPŁATA | RACHUNEK ZA PRĽD     |  -720.50
--      11-11111111 | WYPŁATA | RACHUNEK ZA TELEFON  |  -550.00
--      11-11111111 | WYPŁATA | WYPŁATA W BANKOMACIE | -1050.00
--      11-11111111 | WYPŁATA |                      | -2320.50
--      11-11111111 |         |                      |  7479.50
--      22-22222222 | WPŁATA  | PENSJA               | 10080.00
--      22-22222222 | WPŁATA  | UMOWA O DZIEŁO       |  1820.00
--      22-22222222 | WPŁATA  |                      | 11900.00
--      22-22222222 | WYPŁATA | RACHUNEK ZA PRĽD     |  -790.50
--      22-22222222 | WYPŁATA | RACHUNEK ZA TELEFON  |  -560.00
--      22-22222222 | WYPŁATA | WYPŁATA W BANKOMACIE | -1050.00
--      22-22222222 | WYPŁATA |                      | -2400.50
--      22-22222222 |         |                      |  9499.50
--      33-33333333 | WPŁATA  | PENSJA               |  7420.00
--      33-33333333 | WPŁATA  | UMOWA O DZIEŁO       |  1480.00
--      33-33333333 | WPŁATA  |                      |  8900.00
--      33-33333333 | WYPŁATA | RACHUNEK ZA PRĽD     |  -650.50
--      33-33333333 | WYPŁATA | RACHUNEK ZA TELEFON  |  -440.00
--      33-33333333 | WYPŁATA | WYPŁATA W BANKOMACIE |  -940.00
--      33-33333333 | WYPŁATA |                      | -2030.50
--      33-33333333 |         |                      |  6869.50
--                  |         |                      | 23848.50
--     (25 rows)
--
--     zad2
--
--       nr_konta   |   typ   |   sum
--     -------------+---------+----------
--      11-11111111 | WPŁATA  |  9800.00
--      11-11111111 | WYPŁATA | -2320.50
--      11-11111111 |         |  7479.50
--      22-22222222 | WPŁATA  | 11900.00
--      22-22222222 | WYPŁATA | -2400.50
--      22-22222222 |         |  9499.50
--      33-33333333 | WPŁATA  |  8900.00
--      33-33333333 | WYPŁATA | -2030.50
--      33-33333333 |         |  6869.50
--     (9 rows)
--
--
--     zad3
--
--       nr_konta   |   typ   |        srednia
--     -------------+---------+-----------------------
--      11-11111111 | WPŁATA  | 1400.0000000000000000
--      11-11111111 | WYPŁATA | -257.8333333333333333
--      11-11111111 |         |  467.4687500000000000
--      22-22222222 | WPŁATA  | 1487.5000000000000000
--      22-22222222 | WYPŁATA | -300.0625000000000000
--      22-22222222 |         |  593.7187500000000000
--      33-33333333 | WPŁATA  | 1271.4285714285714286
--      33-33333333 | WYPŁATA | -225.6111111111111111
--      33-33333333 |         |  429.3437500000000000
--                  | WPŁATA  | 1390.9090909090909091
--                  | WYPŁATA | -259.6730769230769231
--                  |         |  496.8437500000000000
--     (12 rows)
--
--     --zad4 Wyznacz rankingi wpłat i wypłat oddzielne dla każdej kategorii dla  nr_konta = '11-11111111'.
--      rank | dense_rank |      kategoria       |    data    |  kwota
--     ------+------------+----------------------+------------+---------
--         1 |          1 | PENSJA               | 1999-11-04 | 1800.00
--         1 |          1 | PENSJA               | 1999-12-02 | 1800.00
--         3 |          2 | PENSJA               | 2001-12-03 | 1650.00
--         4 |          3 | PENSJA               | 1997-01-03 | 1500.00
--         5 |          4 | PENSJA               | 2001-09-03 | 1400.00
--         1 |          1 | RACHUNEK ZA PRĽD     | 1999-12-24 | -120.50
--         2 |          2 | RACHUNEK ZA PRĽD     | 2001-07-16 | -600.00
--         1 |          1 | RACHUNEK ZA TELEFON  | 2000-01-19 | -150.00
--         1 |          1 | RACHUNEK ZA TELEFON  | 1998-05-22 | -150.00
--         3 |          2 | RACHUNEK ZA TELEFON  | 2001-09-29 | -250.00
--         1 |          1 | UMOWA O DZIEŁO       | 2000-05-03 |  900.00
--         2 |          2 | UMOWA O DZIEŁO       | 1997-02-02 |  750.00
--         1 |          1 | WYPŁATA W BANKOMACIE | 1997-01-12 | -100.00
--         2 |          2 | WYPŁATA W BANKOMACIE | 2001-07-24 | -150.00
--         3 |          3 | WYPŁATA W BANKOMACIE | 1999-12-24 | -300.00
--         4 |          4 | WYPŁATA W BANKOMACIE | 2002-01-05 | -500.00
--     (16 rows)
--
--     --zad5  trzy największe wpłaty bez LIMIT
--        kwota  |    data    |  nr_konta
--     ---------+------------+-------------
--      2090.00 | 2001-07-02 | 22-22222222
--      1980.00 | 2001-05-04 | 22-22222222
--      1820.00 | 2003-04-03 | 22-22222222
--     (3 rows)



-- zadanie 1
SELECT
    NR_KONTA,
    TYP,
    KATEGORIA,
    SUM(KWOTA) AS SUM
FROM TRANSAKCJE
GROUP BY GROUPING SETS (
    (NR_KONTA, TYP, KATEGORIA),
    (NR_KONTA, TYP),
    (NR_KONTA),
    ()
)
ORDER BY
    NR_KONTA,
    typ,
    TYP DESC,
    KATEGORIA
;

-- zadanie 2
SELECT
    NR_KONTA,
    TYP,
    SUM(KWOTA) AS SUM
FROM TRANSAKCJE
GROUP BY GROUPING SETS (
    (NR_KONTA, TYP),
    (NR_KONTA)
)
ORDER BY
    NR_KONTA
;

-- zadanie 3
SELECT
    NR_KONTA,
    TYP,
    AVG(KWOTA) AS SREDNIA
FROM TRANSAKCJE
GROUP BY GROUPING SETS (
    (NR_KONTA, TYP),
    (NR_KONTA),
    (TYP),
    ()
)
ORDER BY
    NR_KONTA,
    TYP
;

-- zadanie 4
SELECT
    RANK() OVER (PARTITION BY KATEGORIA ORDER BY KWOTA DESC) AS RANK,
    DENSE_RANK() OVER (PARTITION BY KATEGORIA ORDER BY KWOTA DESC) AS DENSE_RANK,
    KATEGORIA,
    DATA,
    KWOTA
FROM TRANSAKCJE
WHERE NR_KONTA = '11-11111111'
ORDER BY KATEGORIA, KWOTA DESC, DATA
;

-- zadanie 5
SELECT KWOTA, DATA, NR_KONTA
FROM (
    SELECT
        KWOTA,
        DATA,
        NR_KONTA,
        ROW_NUMBER() OVER (ORDER BY KWOTA DESC) AS RN
    FROM TRANSAKCJE
    WHERE KWOTA > 0
) AS SUBQUERY
WHERE RN <= 3
ORDER BY KWOTA DESC
;